# 星痕共鸣伤害统计工具 - Electron 版本

## 🚀 快速开始

### 开发环境运行

1. **安装依赖**
   ```bash
   pnpm install
   ```

2. **开发模式启动**
   ```bash
   pnpm run dev
   ```

3. **生产模式启动**
   ```bash
   pnpm start
   ```

### 构建独立应用

1. **构建所有平台**
   ```bash
   pnpm run build
   ```

2. **仅构建 Windows 版本**
   ```bash
   pnpm run build-win
   ```

3. **打包但不创建安装程序**
   ```bash
   pnpm run pack
   ```

## 📦 构建产物

构建完成后，在 `dist/` 目录下会生成：

- **Windows**: 
  - `星痕共鸣伤害统计工具 Setup.exe` (安装程序)
  - `星痕共鸣伤害统计工具.exe` (便携版)

- **Linux**:
  - `星痕共鸣伤害统计工具.AppImage` (便携版)
  - `星痕共鸣伤害统计工具.deb` (安装包)

- **macOS**:
  - `星痕共鸣伤害统计工具.dmg` (安装镜像)

## ✨ 新功能特性

### 图形化配置界面
- 🖥️ 可视化网络设备选择
- ⚙️ 图形化日志级别配置
- 🎨 现代化 UI 设计
- 📱 响应式布局

### 增强的用户体验
- 🚀 一键启动，无需命令行操作
- 🔄 自动检测网络设备
- 📊 实时状态反馈
- 🌙 深色/浅色主题切换

### 系统集成
- 🏠 系统托盘支持（可选）
- 🖥️ 原生窗口管理
- 📋 系统菜单集成
- 🔐 管理员权限自动申请

## 🛠️ 技术架构

### 主要组件
- **主进程** (`main.js`): Electron 应用入口，窗口管理
- **服务器** (`server.js`): 原有的网络抓包和数据处理逻辑
- **设置界面** (`public/setup.html`): 图形化配置界面
- **数据界面** (`public/index.html`): 实时数据展示界面

### 依赖处理
- ✅ 原生模块 `cap` 已正确编译和打包
- ✅ 所有 Node.js 依赖已包含在应用中
- ✅ 跨平台兼容性已测试

## 🔧 开发说明

### 环境要求
- Node.js >= 22.15.0
- pnpm >= 10.13.1
- 系统网络抓包驱动（WinPcap/Npcap/libpcap）

### 构建要求
- **Windows**: Visual Studio Build Tools, Python 3.x
- **Linux**: libpcap-dev, build-essential
- **macOS**: Xcode Command Line Tools

### 调试模式
使用 `pnpm run dev` 启动开发模式，会自动打开开发者工具。

### 日志查看
- 开发模式：控制台输出
- 生产模式：应用内日志显示

## 🚨 运行要求

### 系统权限
- 应用需要管理员权限进行网络抓包
- Windows 版本会自动申请管理员权限
- Linux/macOS 需要手动以 sudo 运行

### 网络驱动
- **Windows**: 需要安装 Npcap 或 WinPcap
- **Linux**: 需要安装 libpcap
- **macOS**: 系统自带 libpcap

### 游戏要求
- 确保《星痕共鸣》游戏正在运行
- 确保游戏已连接到服务器
- 建议在非人群密集的地图进行测试

## 📝 使用流程

1. **启动应用** - 双击可执行文件或使用命令行
2. **选择网卡** - 在图形界面中选择正确的网络设备
3. **配置日志** - 选择合适的日志级别
4. **启动服务** - 点击"启动服务"按钮
5. **查看数据** - 应用会自动跳转到数据展示界面
6. **开始游戏** - 进入游戏开始战斗，实时查看伤害统计

## 🔍 故障排除

### 常见问题

1. **应用无法启动**
   - 检查是否以管理员权限运行
   - 确认网络驱动已正确安装

2. **找不到网络设备**
   - 重新安装网络抓包驱动
   - 检查防火墙设置

3. **无法检测游戏**
   - 确认游戏正在运行
   - 尝试重新启动应用
   - 检查网络设备选择是否正确

4. **数据不准确**
   - 确保网络环境稳定
   - 尝试切换到人少的地图
   - 重启应用重新捕获

### 获取帮助
- 查看应用内日志信息
- 访问项目 GitHub 页面提交 Issue
- 联系开发者：dmlgzs@qq.com

## 📄 许可证

本项目采用 Mozilla Public License 2.0 许可证。

## 🙏 致谢

感谢原项目作者 Dimole 的开发工作，本 Electron 版本在原有功能基础上增加了图形化界面和更好的用户体验。